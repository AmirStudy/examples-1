!Flow
with:
  driver_yaml_path: my-driver.yml
  sse_logger: false
pods:
  chunk_seg:
    driver: segment
    exec_yaml_path: preprocess/gif2chunk.yml
    replicas: $REPLICAS
  doc_idx:
    driver: index-meta-doc
    exec_yaml_path: index/doc.yml
  tf_encode:
    driver: encode
    exec_yaml_path: encode/encode.yml
    recv_from: chunk_seg
    replicas: $REPLICAS
  chunk_idx:
    driver: index-chunk-and-meta
    exec_yaml_path: index/npvec.yml
  join_all:
    driver: merge
    recv_from: [doc_idx, chunk_idx]